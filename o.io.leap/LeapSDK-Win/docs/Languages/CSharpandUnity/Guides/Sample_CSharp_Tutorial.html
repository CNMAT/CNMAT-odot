<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.10: http://docutils.sourceforge.net/" />
<title>Understanding the C# Sample Application</title>
<style type="text/css">

/*
:Author: David Goodger (goodger@python.org)
:Id: $Id$
:Copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.

See http://docutils.sf.net/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/

/* used to remove borders from tables and images */
.borderless, table.borderless td, table.borderless th {
  border: 0 }

table.borderless td, table.borderless th {
  /* Override padding for "table.docutils td" with "! important".
     The right padding separates the table cells. */
  padding: 0 0.5em 0 0 ! important }

.first {
  /* Override more specific margin styles with "! important". */
  margin-top: 0 ! important }

.last, .with-subtitle {
  margin-bottom: 0 ! important }

.hidden {
  display: none }

a.toc-backref {
  text-decoration: none ;
  color: black }

blockquote.epigraph {
  margin: 2em 5em ; }

dl.docutils dd {
  margin-bottom: 0.5em }

object[type="image/svg+xml"], object[type="application/x-shockwave-flash"] {
  overflow: hidden;
}

/* Uncomment (and remove this text!) to get bold-faced definition list terms
dl.docutils dt {
  font-weight: bold }
*/

div.abstract {
  margin: 2em 5em }

div.abstract p.topic-title {
  font-weight: bold ;
  text-align: center }

div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ;
  border: medium outset ;
  padding: 1em }

div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title {
  font-weight: bold ;
  font-family: sans-serif }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title, .code .error {
  color: red ;
  font-weight: bold ;
  font-family: sans-serif }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication {
  margin: 2em 5em ;
  text-align: center ;
  font-style: italic }

div.dedication p.topic-title {
  font-weight: bold ;
  font-style: normal }

div.figure {
  margin-left: 2em ;
  margin-right: 2em }

div.footer, div.header {
  clear: both;
  font-size: smaller }

div.line-block {
  display: block ;
  margin-top: 1em ;
  margin-bottom: 1em }

div.line-block div.line-block {
  margin-top: 0 ;
  margin-bottom: 0 ;
  margin-left: 1.5em }

div.sidebar {
  margin: 0 0 0.5em 1em ;
  border: medium outset ;
  padding: 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
  font-family: sans-serif ;
  font-size: medium }

div.system-messages {
  margin: 5em }

div.system-messages h1 {
  color: red }

div.system-message {
  border: medium outset ;
  padding: 1em }

div.system-message p.system-message-title {
  color: red ;
  font-weight: bold }

div.topic {
  margin: 2em }

h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }

h1.title {
  text-align: center }

h2.subtitle {
  text-align: center }

hr.docutils {
  width: 75% }

img.align-left, .figure.align-left, object.align-left {
  clear: left ;
  float: left ;
  margin-right: 1em }

img.align-right, .figure.align-right, object.align-right {
  clear: right ;
  float: right ;
  margin-left: 1em }

img.align-center, .figure.align-center, object.align-center {
  display: block;
  margin-left: auto;
  margin-right: auto;
}

.align-left {
  text-align: left }

.align-center {
  clear: both ;
  text-align: center }

.align-right {
  text-align: right }

/* reset inner alignment in figures */
div.align-right {
  text-align: inherit }

/* div.align-center * { */
/*   text-align: left } */

ol.simple, ul.simple {
  margin-bottom: 1em }

ol.arabic {
  list-style: decimal }

ol.loweralpha {
  list-style: lower-alpha }

ol.upperalpha {
  list-style: upper-alpha }

ol.lowerroman {
  list-style: lower-roman }

ol.upperroman {
  list-style: upper-roman }

p.attribution {
  text-align: right ;
  margin-left: 50% }

p.caption {
  font-style: italic }

p.credits {
  font-style: italic ;
  font-size: smaller }

p.label {
  white-space: nowrap }

p.rubric {
  font-weight: bold ;
  font-size: larger ;
  color: maroon ;
  text-align: center }

p.sidebar-title {
  font-family: sans-serif ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
  font-family: sans-serif ;
  font-weight: bold }

p.topic-title {
  font-weight: bold }

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font: inherit }

pre.literal-block, pre.doctest-block, pre.math, pre.code {
  margin-left: 2em ;
  margin-right: 2em }

pre.code .ln { color: grey; } /* line numbers */
pre.code, code { background-color: #eeeeee }
pre.code .comment, code .comment { color: #5C6576 }
pre.code .keyword, code .keyword { color: #3B0D06; font-weight: bold }
pre.code .literal.string, code .literal.string { color: #0C5404 }
pre.code .name.builtin, code .name.builtin { color: #352B84 }
pre.code .deleted, code .deleted { background-color: #DEB0A1}
pre.code .inserted, code .inserted { background-color: #A3D289}

span.classifier {
  font-family: sans-serif ;
  font-style: oblique }

span.classifier-delimiter {
  font-family: sans-serif ;
  font-weight: bold }

span.interpreted {
  font-family: sans-serif }

span.option {
  white-space: nowrap }

span.pre {
  white-space: pre }

span.problematic {
  color: red }

span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation {
  border-left: solid 1px gray;
  margin-left: 1px }

table.docinfo {
  margin: 2em 4em }

table.docutils {
  margin-top: 0.5em ;
  margin-bottom: 0.5em }

table.footnote {
  border-left: solid 1px black;
  margin-left: 1px }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {
  padding-left: 0.5em ;
  padding-right: 0.5em ;
  vertical-align: top }

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold ;
  text-align: left ;
  white-space: nowrap ;
  padding-left: 0 }

h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {
  font-size: 100% }

ul.auto-toc {
  list-style-type: none }

</style>
</head>
<body>
<div class="document" id="understanding-the-c-sample-application">
<h1 class="title">Understanding the C# Sample Application</h1>

<p>This article discusses the C# sample application included with the Leap SDK. After reading this article, you should be ready to access Leap hand tracking data from your own C# applications.</p>
<div class="contents topic" id="topics">
<p class="topic-title first">Topics:</p>
<ul class="simple">
<li><a class="reference internal" href="#overview" id="id1">Overview</a></li>
<li><a class="reference internal" href="#creating-a-controller-object" id="id2">Creating a Controller object</a></li>
<li><a class="reference internal" href="#subclassing-the-listener-class" id="id3">Subclassing the Listener class</a></li>
<li><a class="reference internal" href="#getting-a-frame-of-data" id="id4">Getting a Frame of data</a></li>
<li><a class="reference internal" href="#getting-gestures" id="id5">Getting Gestures</a></li>
<li><a class="reference internal" href="#running-the-sample" id="id6">Running the sample</a></li>
</ul>
</div>
<p>In the Leap SDK folder, you can find the following files used for this article:</p>
<ul class="simple">
<li><tt class="docutils literal">LeapSDK/samples/Sample.cs</tt> — C# sample application</li>
<li>Windows:<ul>
<li><tt class="docutils literal">LeapSDK/lib/LeapCSharp.NET3.5.dll</tt> — Leap C# library for .NET 3.5</li>
<li><tt class="docutils literal">LeapSDK/lib/LeapCSharp.NET4.0.dll</tt> — Leap C# library for .NET 4.0</li>
<li><tt class="docutils literal">LeapSDK/lib/x86/LeapCSharp.dll</tt> — 32-bit Leap C# library for Windows</li>
<li><tt class="docutils literal">LeapSDK/lib/x64/LeapCSharp.dll</tt> — 64-bit Leap C# library for Windows</li>
<li><tt class="docutils literal">LeapSDK/lib/x86/Leap.dll</tt> — 32-bit Leap library for Windows</li>
<li><tt class="docutils literal">LeapSDK/lib/x64/Leap.dll</tt> — 64-bit Leap library for Windows</li>
</ul>
</li>
<li>Mac (Mono):<ul>
<li><tt class="docutils literal">LeapSDK/lib/LeapCSharp.NET3.5.dll</tt> — Leap C# library for .NET 3.5</li>
<li><tt class="docutils literal">LeapSDK/lib/LeapCSharp.NET4.0.dll</tt> — Leap C# library for .NET 4.0</li>
<li><tt class="docutils literal">LeapSDK/lib/libLeapCSharp.dylib</tt> — Leap C# library for Mac</li>
<li><tt class="docutils literal">LeapSDK/lib/libLeap.dylib</tt> — Leap library for Mac</li>
</ul>
</li>
</ul>
<p>Also note that you can find the Leap API reference documentation at <a class="reference external" href="API_Reference/annotated.html">LeapSDK/docs/API_Reference/annotated.html</a>.</p>
<div class="section" id="overview">
<h1><a class="toc-backref" href="#id1">Overview</a></h1>
<p>In a nutshell, the Leap Motion tracking device detects and tracks hands and fingers placed within its field of view. The Leap captures this data one <em>frame</em> at a time. Your applications can use the Leap API to access this data.</p>
<p>The sample application demonstrates how to use the Leap API to listen for frame events dispatched by the Leap and how to access the hand and finger data in each frame. The application is a small command-line program that prints information about detected hands and fingers to standard output. The application is contained in a single file, <tt class="docutils literal">Sample.cs</tt>.</p>
<p>The sample application uses most of the key classes in the Leap API, including:</p>
<ul class="simple">
<li><tt class="docutils literal">Controller</tt> — the interface between the Leap and your application</li>
<li><tt class="docutils literal">Listener</tt> — used to handle events dispatched by the Leap</li>
<li><tt class="docutils literal">Frame</tt> — contains a set of hand and finger tracking data</li>
<li><tt class="docutils literal">Hand</tt> — contains tracking data for a detected hand</li>
<li><tt class="docutils literal">Finger</tt> — contains tracking data for a detected finger</li>
<li><tt class="docutils literal">Vector</tt> — represents a 3D position or directional vector</li>
<li><tt class="docutils literal">Gesture</tt> — represents a recognized gesture.</li>
</ul>
<p>For more detailed information about these classes, pleases refer to the Leap API reference documentation.</p>
</div>
<div class="section" id="creating-a-controller-object">
<h1><a class="toc-backref" href="#id2">Creating a Controller object</a></h1>
<p>The <tt class="docutils literal">Controller</tt> class provides the main interface between the Leap and your application. When you create a Controller object, it connects to the Leap software running on the computer and makes hand tracking data available through <tt class="docutils literal">Frame</tt> objects. You can access these Frame objects by instantiating a Controller object and calling the <tt class="docutils literal">Controller.Frame</tt> method.</p>
<p>If your application has a natural update loop or frame rate, then you can call <tt class="docutils literal">Controller.Frame</tt> as part of this update. Otherwise, you can add a listener to the controller object. The controller object invokes the callback methods defined in your <tt class="docutils literal">Listener</tt> subclass whenever a new frame of tracking data is available (and also for a few other Leap events).</p>
<p>The sample application creates a Controller object in the Sample class's <tt class="docutils literal">Main</tt> method and adds an instance of a Listener subclass to the Controller with the <tt class="docutils literal">Controller.AddListener</tt> method:</p>
<pre class="code csharp literal-block">
<span class="keyword">class</span> <span class="name class">Sample</span>
<span class="punctuation">{</span>
    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="name function">Main</span><span class="punctuation">()</span>
    <span class="punctuation">{</span>
        <span class="comment single">// Create a sample listener and controller
</span>        <span class="name">SampleListener</span> <span class="name">listener</span> <span class="punctuation">=</span> <span class="keyword">new</span> <span class="name">SampleListener</span><span class="punctuation">();</span>
        <span class="name">Controller</span> <span class="name">controller</span> <span class="punctuation">=</span> <span class="keyword">new</span> <span class="name">Controller</span><span class="punctuation">();</span>

        <span class="comment single">// Have the sample listener receive events from the controller
</span>        <span class="name">controller</span><span class="punctuation">.</span><span class="name">AddListener</span><span class="punctuation">(</span><span class="name">listener</span><span class="punctuation">);</span>

        <span class="comment single">// Keep this process running until Enter is pressed
</span>        <span class="name">Console</span><span class="punctuation">.</span><span class="name">WriteLine</span><span class="punctuation">(</span><span class="literal string">&quot;Press Enter to quit...&quot;</span><span class="punctuation">);</span>
        <span class="name">Console</span><span class="punctuation">.</span><span class="name">ReadLine</span><span class="punctuation">();</span>

        <span class="comment single">// Remove the sample listener when done
</span>        <span class="name">controller</span><span class="punctuation">.</span><span class="name">RemoveListener</span><span class="punctuation">(</span><span class="name">listener</span><span class="punctuation">);</span>
        <span class="name">controller</span><span class="punctuation">.</span><span class="name">Dispose</span><span class="punctuation">();</span>
    <span class="punctuation">}</span>
<span class="punctuation">}</span>
</pre>
<p>The application then runs until you press the Enter key. In the meantime, the controller calls the appropriate listener callback methods when events occur. Before running the program, though, you must create your own subclass of the Listener class.</p>
</div>
<div class="section" id="subclassing-the-listener-class">
<h1><a class="toc-backref" href="#id3">Subclassing the Listener class</a></h1>
<p>The sample application defines a <tt class="docutils literal">Listener</tt> subclass, SampleListener, which implements callback methods to handle events dispatched by the Leap. The events include:</p>
<ul class="simple">
<li><tt class="docutils literal">OnInit</tt> — dispatched once, when the controller to which the listener is registered is initialized.</li>
<li><tt class="docutils literal">OnConnect</tt> — dispatched when the controller connects to the Leap and is ready to begin sending frames of motion tracking data.</li>
<li><tt class="docutils literal">OnDisconnect</tt> — dispatched if the controller disconnects from the Leap (for example, if you unplug the Leap device or shut down the Leap software).</li>
<li><tt class="docutils literal">OnExit</tt> — dispatched to a listener when it is removed from a controller.</li>
<li><tt class="docutils literal">OnFrame</tt> — dispatched when a new frame of motion tracking data is available.</li>
</ul>
<p>For three lifecycle event callbacks, <tt class="docutils literal">OnInit</tt>, <tt class="docutils literal">OnDisconnect</tt>, and <tt class="docutils literal">OnExit</tt> the sample application simply prints a message to standard output. For the <tt class="docutils literal">OnConnect</tt>  and <tt class="docutils literal">OnFrame</tt> event, the listener callback does a bit more work. When the controller calls the <tt class="docutils literal">OnConnect</tt> callback, the function enables recognition for all the gesture types. When the controller calls <tt class="docutils literal">OnFrame</tt>, the function gets the latest frame of motion tracking data and prints information about the detected objects to standard output.</p>
</div>
<div class="section" id="getting-a-frame-of-data">
<h1><a class="toc-backref" href="#id4">Getting a Frame of data</a></h1>
<p>The Controller calls the <tt class="docutils literal">OnFrame</tt> callback method when the Leap generates a new frame of motion tracking data.  You can access the new data by calling the <tt class="docutils literal">Controller.Frame()</tt> method, which returns the newest Frame object. (A reference to the Controller object is passed to the callback as a parameter.) A Frame object contains an ID, a timestamp, and a list containing a Hand object for each physical hand in view.</p>
<p>The following code from the sample application's <tt class="docutils literal">OnFrame</tt> implementation gets the most recent Frame object from the controller, retrieves the list of Hands from the Frame and then prints out the Frame ID, timestamp, and the number of Hands in the list:</p>
<pre class="code csharp literal-block">
<span class="comment single">// Get the most recent frame and report some basic information
</span><span class="name">Frame</span> <span class="name">frame</span> <span class="punctuation">=</span> <span class="name">controller</span><span class="punctuation">.</span><span class="name">Frame</span><span class="punctuation">();</span>
<span class="name">SafeWriteLine</span><span class="punctuation">(</span><span class="literal string">&quot;Frame id: &quot;</span> <span class="punctuation">+</span> <span class="name">frame</span><span class="punctuation">.</span><span class="name">Id</span>
            <span class="punctuation">+</span> <span class="literal string">&quot;, timestamp: &quot;</span> <span class="punctuation">+</span> <span class="name">frame</span><span class="punctuation">.</span><span class="name">Timestamp</span>
            <span class="punctuation">+</span> <span class="literal string">&quot;, hands: &quot;</span> <span class="punctuation">+</span> <span class="name">frame</span><span class="punctuation">.</span><span class="name">Hands</span><span class="punctuation">.</span><span class="name">Count</span>
            <span class="punctuation">+</span> <span class="literal string">&quot;, fingers: &quot;</span> <span class="punctuation">+</span> <span class="name">frame</span><span class="punctuation">.</span><span class="name">Fingers</span><span class="punctuation">.</span><span class="name">Count</span>
            <span class="punctuation">+</span> <span class="literal string">&quot;, tools: &quot;</span> <span class="punctuation">+</span> <span class="name">frame</span><span class="punctuation">.</span><span class="name">Tools</span><span class="punctuation">.</span><span class="name">Count</span><span class="punctuation">);</span>
</pre>
<p>The method goes on to examine the first Hand in the list:</p>
<pre class="code csharp literal-block">
<span class="keyword">if</span> <span class="punctuation">(!</span><span class="name">frame</span><span class="punctuation">.</span><span class="name">Hands</span><span class="punctuation">.</span><span class="name">IsEmpty</span><span class="punctuation">)</span>
<span class="punctuation">{</span>
    <span class="comment single">// Get the first hand
</span>    <span class="name">Hand</span> <span class="name">hand</span> <span class="punctuation">=</span> <span class="name">frame</span><span class="punctuation">.</span><span class="name">Hands</span><span class="punctuation">[</span><span class="literal number">0</span><span class="punctuation">];</span>
</pre>
<p>A Hand object contains an ID, properties representing the hand's physical characteristics, and a list of Finger objects. Each Finger object contains an ID and properties representing the characteristic of the finger.</p>
<p>Once it has retrieved a hand, the method checks it for fingers and then averages the finger tip positions, printing the result and the number of fingers:</p>
<pre class="code csharp literal-block">
<span class="comment single">// Check if the hand has any fingers
</span><span class="name">FingerList</span> <span class="name">fingers</span> <span class="punctuation">=</span> <span class="name">hand</span><span class="punctuation">.</span><span class="name">Fingers</span><span class="punctuation">;</span>
<span class="keyword">if</span> <span class="punctuation">(!</span><span class="name">fingers</span><span class="punctuation">.</span><span class="name">IsEmpty</span><span class="punctuation">)</span>
<span class="punctuation">{</span>
    <span class="comment single">// Calculate the hand's average finger tip position
</span>    <span class="name">Vector</span> <span class="name">avgPos</span> <span class="punctuation">=</span> <span class="name">Vector</span><span class="punctuation">.</span><span class="name">Zero</span><span class="punctuation">;</span>
    <span class="keyword">foreach</span> <span class="punctuation">(</span><span class="name">Finger</span> <span class="name">finger</span> <span class="keyword">in</span> <span class="name">fingers</span><span class="punctuation">)</span>
    <span class="punctuation">{</span>
        <span class="name">avgPos</span> <span class="punctuation">+=</span> <span class="name">finger</span><span class="punctuation">.</span><span class="name">TipPosition</span><span class="punctuation">;</span>
    <span class="punctuation">}</span>
    <span class="name">avgPos</span> <span class="punctuation">/=</span> <span class="name">fingers</span><span class="punctuation">.</span><span class="name">Count</span><span class="punctuation">;</span>
    <span class="name">SafeWriteLine</span><span class="punctuation">(</span><span class="literal string">&quot;Hand has &quot;</span> <span class="punctuation">+</span> <span class="name">fingers</span><span class="punctuation">.</span><span class="name">Count</span>
                <span class="punctuation">+</span> <span class="literal string">&quot; fingers, average finger tip position: &quot;</span> <span class="punctuation">+</span> <span class="name">avgPos</span><span class="punctuation">);</span>
<span class="punctuation">}</span>
</pre>
<p>Next, the method prints the radius of a sphere fit to the hand's curvature, along with the hand's palm position:</p>
<pre class="code csharp literal-block">
<span class="comment single">// Get the hand's sphere radius and palm position
</span><span class="name">SafeWriteLine</span><span class="punctuation">(</span><span class="literal string">&quot;Hand sphere radius: &quot;</span> <span class="punctuation">+</span> <span class="name">hand</span><span class="punctuation">.</span><span class="name">SphereRadius</span><span class="punctuation">.</span><span class="name">ToString</span><span class="punctuation">(</span><span class="literal string">&quot;n2&quot;</span><span class="punctuation">)</span>
            <span class="punctuation">+</span> <span class="literal string">&quot; mm, palm position: &quot;</span> <span class="punctuation">+</span> <span class="name">hand</span><span class="punctuation">.</span><span class="name">PalmPosition</span><span class="punctuation">);</span>
</pre>
<p>Finally, the OnFrame method uses Vector methods to calculate the hand's pitch, roll, and yaw angles from the hand's normal vector and the direction vector. The angles are converted from radians to degrees:</p>
<pre class="code csharp literal-block">
<span class="comment single">// Get the hand's normal vector and direction
</span><span class="name">Vector</span> <span class="name">normal</span> <span class="punctuation">=</span> <span class="name">hand</span><span class="punctuation">.</span><span class="name">PalmNormal</span><span class="punctuation">;</span>
<span class="name">Vector</span> <span class="name">direction</span> <span class="punctuation">=</span> <span class="name">hand</span><span class="punctuation">.</span><span class="name">Direction</span><span class="punctuation">;</span>

<span class="comment single">// Calculate the hand's pitch, roll, and yaw angles
</span><span class="name">SafeWriteLine</span><span class="punctuation">(</span><span class="literal string">&quot;Hand pitch: &quot;</span> <span class="punctuation">+</span> <span class="name">direction</span><span class="punctuation">.</span><span class="name">Pitch</span> <span class="punctuation">*</span> <span class="literal number">180.0f</span> <span class="punctuation">/</span> <span class="punctuation">(</span><span class="keyword type">float</span><span class="punctuation">)</span><span class="name">Math</span><span class="punctuation">.</span><span class="name">PI</span>  <span class="punctuation">+</span> <span class="literal string">&quot; degrees, &quot;</span>
            <span class="punctuation">+</span> <span class="literal string">&quot;roll: &quot;</span> <span class="punctuation">+</span> <span class="name">normal</span><span class="punctuation">.</span><span class="name">Roll</span> <span class="punctuation">*</span> <span class="literal number">180.0f</span> <span class="punctuation">/</span> <span class="punctuation">(</span><span class="keyword type">float</span><span class="punctuation">)</span><span class="name">Math</span><span class="punctuation">.</span><span class="name">PI</span> <span class="punctuation">+</span> <span class="literal string">&quot; degrees, &quot;</span>
            <span class="punctuation">+</span> <span class="literal string">&quot;yaw: &quot;</span> <span class="punctuation">+</span> <span class="name">direction</span><span class="punctuation">.</span><span class="name">Yaw</span> <span class="punctuation">*</span> <span class="literal number">180.0f</span> <span class="punctuation">/</span> <span class="punctuation">(</span><span class="keyword type">float</span><span class="punctuation">)</span><span class="name">Math</span><span class="punctuation">.</span><span class="name">PI</span> <span class="punctuation">+</span> <span class="literal string">&quot; degrees\n&quot;</span><span class="punctuation">);</span>
</pre>
</div>
<div class="section" id="getting-gestures">
<h1><a class="toc-backref" href="#id5">Getting Gestures</a></h1>
<p>To receive gestures from the Leap, you first have to enable recognition for each type of gesture you are interested in. You can enable gesture recognition any time after the controller connects to the Leap (<tt class="docutils literal">IsConnected</tt> is true). In the sample program, all gestures are enabled in the <tt class="docutils literal">OnConnect()</tt> callback function using the EnableGesture() methods defined in the Controller class:</p>
<pre class="code csharp literal-block">
<span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="name function">OnConnect</span> <span class="punctuation">(</span><span class="name">Controller</span> <span class="name">controller</span><span class="punctuation">)</span>
<span class="punctuation">{</span>
        <span class="name">SafeWriteLine</span> <span class="punctuation">(</span><span class="literal string">&quot;Connected&quot;</span><span class="punctuation">);</span>
        <span class="name">controller</span><span class="punctuation">.</span><span class="name">EnableGesture</span> <span class="punctuation">(</span><span class="name">Gesture</span><span class="punctuation">.</span><span class="name">GestureType</span><span class="punctuation">.</span><span class="name">TYPECIRCLE</span><span class="punctuation">);</span>
        <span class="name">controller</span><span class="punctuation">.</span><span class="name">EnableGesture</span> <span class="punctuation">(</span><span class="name">Gesture</span><span class="punctuation">.</span><span class="name">GestureType</span><span class="punctuation">.</span><span class="name">TYPEKEYTAP</span><span class="punctuation">);</span>
        <span class="name">controller</span><span class="punctuation">.</span><span class="name">EnableGesture</span> <span class="punctuation">(</span><span class="name">Gesture</span><span class="punctuation">.</span><span class="name">GestureType</span><span class="punctuation">.</span><span class="name">TYPESCREENTAP</span><span class="punctuation">);</span>
        <span class="name">controller</span><span class="punctuation">.</span><span class="name">EnableGesture</span> <span class="punctuation">(</span><span class="name">Gesture</span><span class="punctuation">.</span><span class="name">GestureType</span><span class="punctuation">.</span><span class="name">TYPESWIPE</span><span class="punctuation">);</span>
<span class="punctuation">}</span>
</pre>
<p>The Leap adds Gesture objects representing each recognized movement pattern to the gestures list in the Frame object. In the <tt class="docutils literal">OnFrame()</tt> callback, the sample application loops through the gesture list and prints information about each one to the standard output. This operation is performed with a standard for-loop and switch statement.</p>
<p>The Gesture API uses a base Gesture class which is extended by classes representing the individual gestures. The objects in the gesture list are Gesture instances, so you must convert the Gesture instance to an instance of the correct subclass. Casting is not supported, instead each subclass provides a constructor that performs the conversion. For example, a Gesture instance representing a circle gesture can by converted into a CircleGesture instance with the following code:</p>
<pre class="code csharp literal-block">
<span class="name">CircleGesture</span> <span class="name">circle</span> <span class="punctuation">=</span> <span class="keyword">new</span> <span class="name">CircleGesture</span> <span class="punctuation">(</span><span class="name">gesture</span><span class="punctuation">)</span>
</pre>
<p>If you try to convert a Gesture instance into the wrong subclass, the constructor functions return invalid Gesture objects.</p>
<p>It is sometimes useful to compare the properties of a gesture in the current frame to those from an earlier frame. For example, the circle gesture has a progress attribute that describes how many times the finger has traversed the circle. This is the total progress, however; if you want the progress between frames, you must subtract the progress value of the gesture in the previous frame. You can do this by looking up the gesture in the previous frame using the gesture ID. The following code calculates the progress since the previous frame to derive the angle in degrees:</p>
<pre class="code csharp literal-block">
<span class="comment single">// Calculate angle swept since last frame
</span><span class="keyword type">float</span> <span class="name">sweptAngle</span> <span class="punctuation">=</span> <span class="literal number">0</span><span class="punctuation">;</span>
<span class="keyword">if</span> <span class="punctuation">(</span><span class="name">circle</span><span class="punctuation">.</span><span class="name">State</span> <span class="punctuation">!=</span> <span class="name">Gesture</span><span class="punctuation">.</span><span class="name">GestureState</span><span class="punctuation">.</span><span class="name">STATESTART</span><span class="punctuation">)</span> <span class="punctuation">{</span>
    <span class="name">CircleGesture</span> <span class="name">previousUpdate</span> <span class="punctuation">=</span> <span class="keyword">new</span> <span class="name">CircleGesture</span> <span class="punctuation">(</span><span class="name">controller</span><span class="punctuation">.</span><span class="name">Frame</span> <span class="punctuation">(</span><span class="literal number">1</span><span class="punctuation">).</span><span class="name">Gesture</span> <span class="punctuation">(</span><span class="name">circle</span><span class="punctuation">.</span><span class="name">Id</span><span class="punctuation">));</span>
    <span class="name">sweptAngle</span> <span class="punctuation">=</span> <span class="punctuation">(</span><span class="name">circle</span><span class="punctuation">.</span><span class="name">Progress</span> <span class="punctuation">-</span> <span class="name">previousUpdate</span><span class="punctuation">.</span><span class="name">Progress</span><span class="punctuation">)</span> <span class="punctuation">*</span> <span class="literal number">360</span><span class="punctuation">;</span>
<span class="punctuation">}</span>
</pre>
<p>The full code for the gesture loop is:</p>
<pre class="code csharp literal-block">
<span class="comment single">// Get gestures
</span><span class="name">GestureList</span> <span class="name">gestures</span> <span class="punctuation">=</span> <span class="name">frame</span><span class="punctuation">.</span><span class="name">Gestures</span> <span class="punctuation">();</span>
<span class="keyword">for</span> <span class="punctuation">(</span><span class="keyword type">int</span> <span class="name">i</span> <span class="punctuation">=</span> <span class="literal number">0</span><span class="punctuation">;</span> <span class="name">i</span> <span class="punctuation">&lt;</span> <span class="name">gestures</span><span class="punctuation">.</span><span class="name">Count</span><span class="punctuation">;</span> <span class="name">i</span><span class="punctuation">++)</span> <span class="punctuation">{</span>
        <span class="name">Gesture</span> <span class="name">gesture</span> <span class="punctuation">=</span> <span class="name">gestures</span> <span class="punctuation">[</span><span class="name">i</span><span class="punctuation">];</span>

        <span class="keyword">switch</span> <span class="punctuation">(</span><span class="name">gesture</span><span class="punctuation">.</span><span class="name">Type</span><span class="punctuation">)</span> <span class="punctuation">{</span>
        <span class="keyword">case</span> <span class="name">Gesture</span><span class="punctuation">.</span><span class="name">GestureType</span><span class="punctuation">.</span><span class="name">TYPECIRCLE</span><span class="punctuation">:</span>
                <span class="name">CircleGesture</span> <span class="name">circle</span> <span class="punctuation">=</span> <span class="keyword">new</span> <span class="name">CircleGesture</span> <span class="punctuation">(</span><span class="name">gesture</span><span class="punctuation">);</span>

    <span class="comment single">// Calculate clock direction using the angle between circle normal and pointable
</span>                <span class="name">String</span> <span class="name">clockwiseness</span><span class="punctuation">;</span>
                <span class="keyword">if</span> <span class="punctuation">(</span><span class="name">circle</span><span class="punctuation">.</span><span class="name">Pointable</span><span class="punctuation">.</span><span class="name">Direction</span><span class="punctuation">.</span><span class="name">AngleTo</span> <span class="punctuation">(</span><span class="name">circle</span><span class="punctuation">.</span><span class="name">Normal</span><span class="punctuation">)</span> <span class="punctuation">&lt;=</span> <span class="name">Math</span><span class="punctuation">.</span><span class="name">PI</span> <span class="punctuation">/</span> <span class="literal number">4</span><span class="punctuation">)</span> <span class="punctuation">{</span>
                        <span class="comment single">//Clockwise if angle is less than 90 degrees
</span>                        <span class="name">clockwiseness</span> <span class="punctuation">=</span> <span class="literal string">&quot;clockwise&quot;</span><span class="punctuation">;</span>
                <span class="punctuation">}</span> <span class="keyword">else</span> <span class="punctuation">{</span>
                        <span class="name">clockwiseness</span> <span class="punctuation">=</span> <span class="literal string">&quot;counterclockwise&quot;</span><span class="punctuation">;</span>
                <span class="punctuation">}</span>

                <span class="keyword type">float</span> <span class="name">sweptAngle</span> <span class="punctuation">=</span> <span class="literal number">0</span><span class="punctuation">;</span>

    <span class="comment single">// Calculate angle swept since last frame
</span>                <span class="keyword">if</span> <span class="punctuation">(</span><span class="name">circle</span><span class="punctuation">.</span><span class="name">State</span> <span class="punctuation">!=</span> <span class="name">Gesture</span><span class="punctuation">.</span><span class="name">GestureState</span><span class="punctuation">.</span><span class="name">STATESTART</span><span class="punctuation">)</span> <span class="punctuation">{</span>
                        <span class="name">CircleGesture</span> <span class="name">previousUpdate</span> <span class="punctuation">=</span> <span class="keyword">new</span> <span class="name">CircleGesture</span> <span class="punctuation">(</span><span class="name">controller</span><span class="punctuation">.</span><span class="name">Frame</span> <span class="punctuation">(</span><span class="literal number">1</span><span class="punctuation">).</span><span class="name">Gesture</span> <span class="punctuation">(</span><span class="name">circle</span><span class="punctuation">.</span><span class="name">Id</span><span class="punctuation">));</span>
                        <span class="name">sweptAngle</span> <span class="punctuation">=</span> <span class="punctuation">(</span><span class="name">circle</span><span class="punctuation">.</span><span class="name">Progress</span> <span class="punctuation">-</span> <span class="name">previousUpdate</span><span class="punctuation">.</span><span class="name">Progress</span><span class="punctuation">)</span> <span class="punctuation">*</span> <span class="literal number">360</span><span class="punctuation">;</span>
                <span class="punctuation">}</span>

                <span class="name">SafeWriteLine</span> <span class="punctuation">(</span><span class="literal string">&quot;Circle id: &quot;</span> <span class="punctuation">+</span> <span class="name">circle</span><span class="punctuation">.</span><span class="name">Id</span>
               <span class="punctuation">+</span> <span class="literal string">&quot;, &quot;</span> <span class="punctuation">+</span> <span class="name">circle</span><span class="punctuation">.</span><span class="name">State</span>
               <span class="punctuation">+</span> <span class="literal string">&quot;, progress: &quot;</span> <span class="punctuation">+</span> <span class="name">circle</span><span class="punctuation">.</span><span class="name">Progress</span>
               <span class="punctuation">+</span> <span class="literal string">&quot;, radius: &quot;</span> <span class="punctuation">+</span> <span class="name">circle</span><span class="punctuation">.</span><span class="name">Radius</span>
               <span class="punctuation">+</span> <span class="literal string">&quot;, angle: &quot;</span> <span class="punctuation">+</span> <span class="name">sweptAngle</span>
               <span class="punctuation">+</span> <span class="literal string">&quot;, &quot;</span> <span class="punctuation">+</span> <span class="name">clockwiseness</span><span class="punctuation">);</span>
                <span class="keyword">break</span><span class="punctuation">;</span>
        <span class="keyword">case</span> <span class="name">Gesture</span><span class="punctuation">.</span><span class="name">GestureType</span><span class="punctuation">.</span><span class="name">TYPESWIPE</span><span class="punctuation">:</span>
                <span class="name">SwipeGesture</span> <span class="name">swipe</span> <span class="punctuation">=</span> <span class="keyword">new</span> <span class="name">SwipeGesture</span> <span class="punctuation">(</span><span class="name">gesture</span><span class="punctuation">);</span>
                <span class="name">SafeWriteLine</span> <span class="punctuation">(</span><span class="literal string">&quot;Swipe id: &quot;</span> <span class="punctuation">+</span> <span class="name">swipe</span><span class="punctuation">.</span><span class="name">Id</span>
               <span class="punctuation">+</span> <span class="literal string">&quot;, &quot;</span> <span class="punctuation">+</span> <span class="name">swipe</span><span class="punctuation">.</span><span class="name">State</span>
               <span class="punctuation">+</span> <span class="literal string">&quot;, position: &quot;</span> <span class="punctuation">+</span> <span class="name">swipe</span><span class="punctuation">.</span><span class="name">Position</span>
               <span class="punctuation">+</span> <span class="literal string">&quot;, direction: &quot;</span> <span class="punctuation">+</span> <span class="name">swipe</span><span class="punctuation">.</span><span class="name">Direction</span>
               <span class="punctuation">+</span> <span class="literal string">&quot;, speed: &quot;</span> <span class="punctuation">+</span> <span class="name">swipe</span><span class="punctuation">.</span><span class="name">Speed</span><span class="punctuation">);</span>
                <span class="keyword">break</span><span class="punctuation">;</span>
        <span class="keyword">case</span> <span class="name">Gesture</span><span class="punctuation">.</span><span class="name">GestureType</span><span class="punctuation">.</span><span class="name">TYPEKEYTAP</span><span class="punctuation">:</span>
                <span class="name">KeyTapGesture</span> <span class="name">keytap</span> <span class="punctuation">=</span> <span class="keyword">new</span> <span class="name">KeyTapGesture</span> <span class="punctuation">(</span><span class="name">gesture</span><span class="punctuation">);</span>
                <span class="name">SafeWriteLine</span> <span class="punctuation">(</span><span class="literal string">&quot;Tap id: &quot;</span> <span class="punctuation">+</span> <span class="name">keytap</span><span class="punctuation">.</span><span class="name">Id</span>
               <span class="punctuation">+</span> <span class="literal string">&quot;, &quot;</span> <span class="punctuation">+</span> <span class="name">keytap</span><span class="punctuation">.</span><span class="name">State</span>
               <span class="punctuation">+</span> <span class="literal string">&quot;, position: &quot;</span> <span class="punctuation">+</span> <span class="name">keytap</span><span class="punctuation">.</span><span class="name">Position</span>
               <span class="punctuation">+</span> <span class="literal string">&quot;, direction: &quot;</span> <span class="punctuation">+</span> <span class="name">keytap</span><span class="punctuation">.</span><span class="name">Direction</span><span class="punctuation">);</span>
                <span class="keyword">break</span><span class="punctuation">;</span>
        <span class="keyword">case</span> <span class="name">Gesture</span><span class="punctuation">.</span><span class="name">GestureType</span><span class="punctuation">.</span><span class="name">TYPESCREENTAP</span><span class="punctuation">:</span>
                <span class="name">ScreenTapGesture</span> <span class="name">screentap</span> <span class="punctuation">=</span> <span class="keyword">new</span> <span class="name">ScreenTapGesture</span> <span class="punctuation">(</span><span class="name">gesture</span><span class="punctuation">);</span>
                <span class="name">SafeWriteLine</span> <span class="punctuation">(</span><span class="literal string">&quot;Tap id: &quot;</span> <span class="punctuation">+</span> <span class="name">screentap</span><span class="punctuation">.</span><span class="name">Id</span>
               <span class="punctuation">+</span> <span class="literal string">&quot;, &quot;</span> <span class="punctuation">+</span> <span class="name">screentap</span><span class="punctuation">.</span><span class="name">State</span>
               <span class="punctuation">+</span> <span class="literal string">&quot;, position: &quot;</span> <span class="punctuation">+</span> <span class="name">screentap</span><span class="punctuation">.</span><span class="name">Position</span>
               <span class="punctuation">+</span> <span class="literal string">&quot;, direction: &quot;</span> <span class="punctuation">+</span> <span class="name">screentap</span><span class="punctuation">.</span><span class="name">Direction</span><span class="punctuation">);</span>
                <span class="keyword">break</span><span class="punctuation">;</span>
        <span class="keyword">default</span><span class="punctuation">:</span>
                <span class="name">SafeWriteLine</span> <span class="punctuation">(</span><span class="literal string">&quot;Unknown gesture type.&quot;</span><span class="punctuation">);</span>
                <span class="keyword">break</span><span class="punctuation">;</span>
        <span class="punctuation">}</span>
<span class="punctuation">}</span>
</pre>
</div>
<div class="section" id="running-the-sample">
<h1><a class="toc-backref" href="#id6">Running the sample</a></h1>
<p>To run the sample application:</p>
<ol class="arabic simple">
<li>Compile the sample application:</li>
</ol>
<blockquote>
<ul>
<li><p class="first">On Windows, make sure that <tt class="docutils literal">Sample.cs</tt> and either <tt class="docutils literal">LeapCSharp.NET3.5.dll</tt> or <tt class="docutils literal">LeapCSharp.NET4.0.dll</tt> are in the current directory. Run the following command in a command-line prompt (using the proper library reference for the .NET framework you are using):</p>
<p><tt class="docutils literal">csc /reference:LeapCSharp.NET4.0.dll /platform:x86 /target:exe Sample.cs</tt></p>
<p><em>Note: use the ``csc`` compiler from the appropriate version of the .NET framework.</em></p>
</li>
<li><p class="first">On Mac, you can use the Mono project to compile C# programs. Make sure that <tt class="docutils literal">Sample.cs</tt> and either <tt class="docutils literal">LeapCSharp.NET3.5.dll</tt> or <tt class="docutils literal">LeapCSharp.NET4.0.dll</tt> are in the current directory:</p>
</li>
<li><p class="first">For the .NET 3.5 framework, run:</p>
<p><tt class="docutils literal">gmcs /reference:LeapCSharp.NET3.5.dll /platform:x86 /target:exe Sample.cs</tt></p>
</li>
<li><p class="first">For the .NET 4.0 framework, run:</p>
<p><tt class="docutils literal">dmcs /reference:LeapCSharp.NET4.0.dll /platform:x86 /target:exe Sample.cs</tt></p>
</li>
</ul>
</blockquote>
<ol class="arabic simple">
<li>Plug the Leap device into a USB port and place it in front of you.</li>
<li>If you haven't already, install the Leap software.</li>
<li>Start the Leap software. If prompted, enter your registered email address and password when prompted. The Leap icon appears in the notification area of the task bar (on Windows) or finder bar (on Mac) and turns green when ready.</li>
<li>Run the sample application:</li>
</ol>
<blockquote>
<ul>
<li><p class="first">On Windows, make sure that <tt class="docutils literal">Sample.exe</tt>, <tt class="docutils literal">LeapCSharp.dll</tt>, <tt class="docutils literal">Leap.dll</tt> and either <tt class="docutils literal">LeapCSharp.NET3.5.dll</tt>, or <tt class="docutils literal">LeapCSharp.NET4.0.dll</tt> are in the current directory. Use the libraries in the <tt class="docutils literal">lib\x86</tt> directory for 32-bit projects. Use the libraries in the <tt class="docutils literal">lib\x64</tt> directory for 64-bit projects. Run the following command in a command-line prompt:</p>
<p><tt class="docutils literal">Sample.exe</tt></p>
</li>
<li><p class="first">On Mac, make sure that <tt class="docutils literal">Sample.exe</tt>, <tt class="docutils literal">libLeapCSharp.dylib</tt>, <tt class="docutils literal">libLeap.dylib</tt> and either <tt class="docutils literal">LeapCSharp.NET3.5.dll</tt>, or <tt class="docutils literal">LeapCSharp.NET4.0.dll</tt> are in the current directory and run the following command in a terminal window:</p>
<p><tt class="docutils literal">mono Sample.exe</tt></p>
</li>
</ul>
</blockquote>
<p>You should see the messages &quot;Initialized&quot; and &quot;Connected&quot; printed to standard output when the application initializes and connects to the Leap. You should then see frame information printed each time the Leap dispatches the <tt class="docutils literal">onFrame</tt> event. When you place a hand above the Leap, you should also see finger and palm position information printed.</p>
<p>Now that you have seen how to access motion tracking data from the Leap, you can begin developing your own C# applications that integrate the Leap.</p>
<hr class="docutils" />
<p>Copyright © 2012-2013 Leap Motion, Inc. All rights reserved.</p>
<p>Leap Motion proprietary and confidential. Not for distribution. Use subject to the terms of the Leap Motion SDK Agreement available at <a class="reference external" href="https://developer.leapmotion.com/sdk_agreement">https://developer.leapmotion.com/sdk_agreement</a>, or another agreement between Leap Motion and you, your company or other organization.</p>
</div>
</div>
</body>
</html>
